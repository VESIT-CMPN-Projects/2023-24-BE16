{% extends 'adminNavbar/navbar.html' %}
{% load static %}

{% block content %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User List</title>
    <!-- Add these scripts to the head section of your HTML -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css">
    <script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lg-thumbnail.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lg-fullscreen.min.js"></script>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">

    <!-- Custom Styles -->
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Arial', sans-serif;
        }
    
        .container {
            margin-top: 50px;
            max-width: 1200px;
            /* margin-left: 125px; */
            /* margin-right: 15px; */
            overflow-x: auto; /* Add a scrollbar for overflow */
            margin-bottom: 100px;
        }
    
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
    
        table,
        th,
        td {
            border: 1px solid #dee2e6;
        }
    
        th,
        td {
            padding: 12px;
            text-align: left;
        }
    
        th {
            background-color: #007bff; /* Updated color here */
            color: white;
        }
    
        .document-image {
            max-width: 100px;
            max-height: 100px;
            overflow: hidden;
        }
    
        .lg-back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
            display: none;
        }
    
        .table {
            max-width: 100%;
            overflow-x: auto;
        }
    
        .btn-approve {
            max-width: 100px;
        }
    
        /* Adjust image size within table cells */
        .document-link img {
            max-width: 100%;
            max-height: 100%;
        }
    </style>
</head>

<body>

    <div class="container">
        <h2 class="text-center mb-4">User List</h2>

        <table class="table table-striped" id="user-list">
            <thead>
                <tr>
                    <th scope="col">First Name</th>
                    <th scope="col">Last Name</th>
                    <th scope="col">Username</th>
                    <th scope="col">Email</th>
                    <th scope="col">Aadhaar Card</th>
                    <th scope="col">Aadhaar Number</th>
                    <th scope="col">PAN Card</th>
                    <th scope="col">PAN Number</th>
                    <th scope="col">Address Proof</th>
                    <th scope="col">Income Certificate</th>
                    <th scope="col">Ration Card</th>
                    <th scope="col">Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for user in user_list %}
                <tr>
                    <td>{{ user.first_name }}</td>
                    <td>{{ user.last_name }}</td>
                    <td>{{ user.username }}</td>
                    <td>{{ user.email }}</td>
                    <td>{% if user.aadhaar_card_image %}<a href="{{ user.aadhaar_card_image.url }}"
                            class="document-link" data-lg-size="1080-720"><img
                                src="{{ user.aadhaar_card_image.url }}" alt="Aadhaar Card" class="document-image"></a>{% endif %}
                    </td>
                    <td>{{ user.aadhaar_card_text }}</td>
                    <td>{% if user.pan_card_image %}<a href="{{ user.pan_card_image.url }}" class="document-link"
                            data-lg-size="1080-720"><img src="{{ user.pan_card_image.url }}" alt="Aadhaar Card"
                                class="document-image"></a>{% endif %}</td>
                    <td>{{ user.pan_card_text }}</td>
                    <td>{% if user.proof_of_address_electricity_image %}<a
                            href="{{ user.proof_of_address_electricity_image.url }}" class="document-link"
                            data-lg-size="1080-720"><img
                                src="{{ user.proof_of_address_electricity_image.url }}" alt="Aadhaar Card"
                                class="document-image"></a>{% endif %}</td>
                    <td>{% if user.income_certificate_image %}<a href="{{ user.income_certificate_image.url }}"
                            class="document-link" data-lg-size="1080-720"><img
                                src="{{ user.income_certificate_image.url }}" alt="Aadhaar Card"
                                class="document-image"></a>{% endif %}</td>
                    <td>{% if user.bpl_ration_card_image %}<a href="{{ user.bpl_ration_card_image.url }}"
                            class="document-link" data-lg-size="1080-720"><img
                                src="{{ user.bpl_ration_card_image.url }}" alt="Aadhaar Card"
                                class="document-image"></a>{% endif %}</td>
                    <td>
                        {% if not user.is_approved %}
                        <form method="post" action="{% url 'account:approve_user' user.id %}">
                            {% csrf_token %}
                            <button type="submit" class="btn btn-success btn-approve">Approve</button>
                        </form>
                        {% else %}
                        Approved
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Add the back button outside the container div -->
    <button class="lg-back-btn" onclick="history.back()">Back</button>

    <!-- Bootstrap JS and Popper.js -->
    <script src="{% static 'js/jquery-3.3.1.min.js' %}"></script>
    <script src="{% static 'js/popper.min.js' %}"></script>
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
    <script>
        $(document).ready(function () {
            // Initialize lightgallery
            $("#user-list").lightGallery({
                selector: '.document-link',
                download: false,
                getCaptionFromTitleOrAlt: false,
                counter: false,
                hideBarsDelay: 1000
            });

            // Hide the custom back button initially
            $('.lg-back-btn').hide();

            // Show the custom back button when the gallery is opened
            $('#user-list').on('onOpen.lg', function (event, index, fromTouch, fromThumb) {
                $('.lg-back-btn').show();
            });

            // Hide the custom back button when the gallery is closed
            $('#user-list').on('onCloseAfter.lg', function (event, index, fromTouch, fromThumb) {
                $('.lg-back-btn').hide();
            });
        });
    </script>

</body>

</html>
{% endblock %}
